% входные данные 
% Требуемое распределение
% requireradius =  [0.27027027	0.810810811	1.351351351	1.891891892	2.432432432	2.972972973	3.513513514	4.054054054	4.594594595	5.135135135	5.675675676	6.216216216	6.756756757	7.297297297	7.837837838	8.378378378	8.918918919	9.459459459	10	10.54054054	11.08108108	11.62162162	12.16216216	12.7027027	13.24324324	13.78378378	14.32432432	14.86486486	15.40540541	15.94594595	16.48648649	17.02702703	17.56756757	18.10810811	18.64864865	19.18918919	19.72972973	20.27027027	20.81081081	21.35135135];
% 
% 
% if currentfraction == 5
%     requiredistribution = [1	0.963057549	0.926467351	0.896658007	0.877460262	0.814076879	0.747126943	0.639381797	0.609660517	0.529347012	0.442626921	0.413456035	0.320791687	0.218528466	0.136123464	0.133481573	0.062370657	0.05539166	0.054731188	0.002226838	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];
%     Fraction2PhaseReq = 0.0782;
% elseif currentfraction == 10
%     requiredistribution = [1	0.969303026	0.935959313	0.908739426	0.88642379	0.832260799	0.775364575	0.707336482	0.689025551	0.630667566	0.546629301	0.517662221	0.442792395	0.369764907	0.280251527	0.264241355	0.17658761	0.11881779	0.094945249	0.009875242	0.00511501	0.002728005	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];
%     Fraction2PhaseReq = 0.1996;
% elseif currentfraction == 15
%     requiredistribution = [1	0.985895815	0.968930876	0.955522224	0.947272606	0.919493653	0.890613943	0.845954724	0.824731918	0.773776619	0.716930465	0.692544499	0.623916633	0.532039845	0.449918653	0.42319207	0.362795677	0.302175504	0.286861698	0.072591812	0.059129174	0.054172608	0.050850435	0.030929451	0.026594609	0.022612823	0.015186586	0.015084975	0.014819752	0.014881752	0.012208858	0.012067635	0.01211758	0.011976357	0.004713732	0.004713732	0.00461212	0.00461212	0.00461212	0.004515676];
%     Fraction2PhaseReq = 0.2841;
% elseif currentfraction == 30
%     requireradius30 = [0.135135135	0.405405405	0.675675676	0.945945946	1.216216216	1.486486486	1.756756757	2.027027027	2.297297297	2.567567568	2.837837838	3.108108108	3.378378378	3.648648649	3.918918919	4.189189189	4.459459459	4.72972973	5	5.27027027	5.540540541	5.810810811	6.081081081	6.351351351	6.621621622	6.891891892	7.162162162	7.432432432	7.702702703	7.972972973	8.243243243	8.513513514	8.783783784	9.054054054	9.324324324	9.594594595	9.864864865	10.13513514];
%     requiredistribution = [1	0.981569208	0.966321518	0.953264553	0.944021071	0.914861348	0.881619763	0.849395522	0.828262213	0.788205042	0.737356526	0.710743286	0.668451701	0.616392358	0.570306015	0.548454947	0.472197777	0.424082985	0.39649609	0.356894539	0.313154955	0.296022369	0.280281611	0.245236267	0.198170028	0.196447407	0.157544891	0.139444892	0.133409478	0.131087685	0.110534824	0.091092928	0.079639997	0.05177224	0.049899826	0.048888722	0.04294693	0];
%     Fraction2PhaseReq = 0.2759;
%     % добавить позже
% end
requireradius = [0.09 0.27 0.45	0.63 0.81 0.99 1.16 1.34 1.52 1.70 1.88 2.06 2.24 2.42 2.60	2.78 2.96 3.14 3.32	3.49 3.67];
requidistribution = [1.00 1.00 0.98	0.97 0.96 0.90 0.81	0.70 0.65 0.54 0.43	0.37 0.28 0.20 0.15	0.13 0.08 0.05 0.04 0.01 0.00];
%Fraction2PhaseReq = 0.35;



% размер системы
L= [20 20 20];
% радиусы сфер для построения
startradius = requireradius(3:4:end)/2;
startredius(1) = requireradius(2);
startdistribution = requidistribution(3:4:end);
startdistribution(3:end) = startdistribution(3:end)/4;
%startdistribution(4:end) = startdistribution(4:end)*5;
% начальный коэффициент для доли фазы 
koef2Phase = 2500;
% погрешность доли фазы
Precision = 0.005;
% шаг в плоскости для постройки псд
turnPSD = L(3)/2;